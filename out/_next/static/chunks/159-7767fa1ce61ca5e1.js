"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[159],{8016:function(e,t,n){n.d(t,{Z:function(){return f}});var a=n(7437),r=n(3145),l=n(8706),i=n(9234),o=n(9376),s=n(2265),u=n(8129);function c(){let e=(0,i.bU)(),t=(0,o.useRouter)(),n=(0,o.usePathname)(),[r,l]=(0,s.useTransition)(),c=a=>{a!==e&&l(()=>{let e=n.split("/");u.k1.includes(e[1])?e[1]=a:e.splice(1,0,a),t.push(e.join("/"))})};return(0,a.jsx)("div",{className:"flex gap-1",children:u.k1.map(t=>(0,a.jsx)("button",{onClick:()=>c(t),disabled:r,className:"tui-btn px-2 py-1 text-xs transition-all ".concat(e===t?"":"opacity-60"," ").concat(r?"opacity-50 cursor-wait":""),style:e===t?{background:"var(--tui-water)",color:"var(--tui-bg)"}:void 0,title:u.he[t],children:u.sg[t]},t))})}function d(){let[e,t]=(0,s.useState)("system"),[n,r]=(0,s.useState)(!1);(0,s.useEffect)(()=>{r(!0);let e=localStorage.getItem("theme");e&&["system","light","dark"].includes(e)&&(t(e),l(e))},[]);let l=e=>{"system"===e?document.documentElement.removeAttribute("data-theme"):document.documentElement.setAttribute("data-theme",e)};if(!n)return(0,a.jsx)("button",{className:"tui-btn opacity-0","aria-hidden":!0,children:"[A]"});let i="system"===e?"Auto":"dark"===e?"Dark":"Light";return(0,a.jsxs)("button",{onClick:()=>{let n="system"===e?"dark":"dark"===e?"light":"system";t(n),localStorage.setItem("theme",n),l(n)},className:"tui-btn",title:"Theme: ".concat(i," (click to cycle)"),"aria-label":"Current theme: ".concat(i,". Click to change."),children:["[","system"===e?"A":"dark"===e?"D":"L","]"]})}function f(){let e=(0,l.T)("common.app");return(0,a.jsx)("header",{className:"tui-bg-panel border-b tui-border-color",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-1 py-1 sm:px-2 sm:py-2 md:px-3 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(r.default,{src:"/bazingse-logo.png",alt:"BaZingSe Logo",width:48,height:48,className:"w-12 h-12 object-contain"}),(0,a.jsx)("div",{children:(0,a.jsx)("h1",{className:"text-xl font-bold tui-text",children:e("title")})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(d,{}),(0,a.jsx)(c,{})]})]})})}},7776:function(e,t,n){n.d(t,{RH:function(){return s},Lk:function(){return f},YU:function(){return u},L0:function(){return c}});var a=n(7437),r=n(2265);let l=(0,r.createContext)(null);function i(e){let{children:t,onSubmit:n,onCancel:i}=e,[o,s]=(0,r.useState)(null),[u,c]=(0,r.useState)(!1),d=(0,r.useRef)(new Map),f=(0,r.useCallback)((e,t,n)=>{d.current.set(e,{id:e,ref:t,order:n})},[]),h=(0,r.useCallback)(e=>{d.current.delete(e)},[]),m=(0,r.useCallback)(()=>Array.from(d.current.values()).sort((e,t)=>e.order-t.order),[]),p=(0,r.useCallback)(e=>{let t=d.current.get(e);(null==t?void 0:t.ref.current)&&(t.ref.current.focus(),s(e))},[]),y=(0,r.useCallback)(()=>{let e=m();if(0===e.length)return;let t=e.findIndex(e=>e.id===o),n=t<e.length-1?t+1:0,a=e[n];(null==a?void 0:a.ref.current)&&(a.ref.current.focus(),s(a.id))},[o,m]),v=(0,r.useCallback)(()=>{let e=m();if(0===e.length)return;let t=e.findIndex(e=>e.id===o),n=t>0?t-1:e.length-1,a=e[n];(null==a?void 0:a.ref.current)&&(a.ref.current.focus(),s(a.id))},[o,m]),b=(0,r.useCallback)(e=>{"Escape"===e.key&&i&&(e.preventDefault(),i())},[i]);return(0,a.jsx)(l.Provider,{value:{focusedFieldId:o,setFocusedFieldId:s,registerField:f,unregisterField:h,focusNextField:y,focusPreviousField:v,focusField:p,isSubmitting:u,setIsSubmitting:c},children:(0,a.jsx)("div",{onKeyDown:b,children:t})})}function o(e){let{title:t,children:n,onSubmit:i,onCancel:o,submitLabel:s="Submit",cancelLabel:u="Cancel",isValid:c=!0,error:d,className:f=""}=e,{isSubmitting:h,setIsSubmitting:m}=function(){let e=(0,r.useContext)(l);if(!e)throw Error("useChatForm must be used within a ChatFormProvider");return e}(),p=(0,r.useCallback)(async e=>{if(e.preventDefault(),c&&!h){m(!0);try{await i()}finally{m(!1)}}},[c,h,i,m]),y=(0,r.useCallback)(e=>{"Enter"!==e.key||e.shiftKey||"TEXTAREA"===e.target.tagName||(e.preventDefault(),c&&!h&&p(e)),"Escape"===e.key&&o&&(e.preventDefault(),o())},[c,h,p,o]);return(0,a.jsxs)("form",{onSubmit:p,onKeyDown:y,className:"chat-form tui-frame ".concat(f),role:"form",children:[(0,a.jsx)("div",{className:"chat-form-title tui-frame-title",children:t}),(0,a.jsxs)("div",{className:"chat-form-body",children:[n,d&&(0,a.jsx)("div",{className:"chat-form-error",role:"alert",children:d})]}),(0,a.jsxs)("div",{className:"chat-form-footer",children:[(0,a.jsxs)("div",{className:"chat-form-shortcuts",children:[(0,a.jsxs)("span",{className:"chat-form-shortcut",children:[(0,a.jsx)("kbd",{children:"Tab"})," Next"]}),o&&(0,a.jsxs)("span",{className:"chat-form-shortcut",children:[(0,a.jsx)("kbd",{children:"Esc"})," ",u]}),(0,a.jsxs)("span",{className:"chat-form-shortcut",children:[(0,a.jsx)("kbd",{children:"Enter"})," ",s]})]}),(0,a.jsxs)("div",{className:"chat-form-actions",children:[o&&(0,a.jsx)("button",{type:"button",onClick:o,className:"tui-btn",disabled:h,children:u}),(0,a.jsx)("button",{type:"submit",className:"tui-btn chat-form-submit",disabled:!c||h,children:h?"Saving...":s})]})]})]})}function s(e){return(0,a.jsx)(i,{onSubmit:e.onSubmit,onCancel:e.onCancel,children:(0,a.jsx)(o,{...e})})}function u(e){let{year:t,month:n,day:l,onYearChange:i,onMonthChange:o,onDayChange:s,onComplete:u,disabled:c=!1,hasError:d=!1,yearPlaceholder:f="YYYY",monthPlaceholder:h="MM",dayPlaceholder:m="DD",className:p="",autoFocusYear:y=!1,yearRef:v}=e,b=(0,r.useRef)(null),g=v||b,x=(0,r.useRef)(null),k=(0,r.useRef)(null);(0,r.useEffect)(()=>{y&&g.current&&g.current.focus()},[y,g]);let j=e=>{let t=parseInt(e,10);return!isNaN(t)&&t>=1900&&t<=2100},C=(0,r.useCallback)(e=>{let t=e.target.value;/^\d*$/.test(t)&&!(t.length>4)&&(i(t),4===t.length&&j(t)&&setTimeout(()=>{var e;return null===(e=x.current)||void 0===e?void 0:e.focus()},0))},[i]),w=(0,r.useCallback)(e=>{let t=e.target.value;if(!/^\d*$/.test(t)||t.length>2)return;let n=parseInt(t,10);!(n>12)&&(o(t),(2===t.length||1===t.length&&n>1)&&setTimeout(()=>{var e;return null===(e=k.current)||void 0===e?void 0:e.focus()},0))},[o]),D=(0,r.useCallback)(e=>{let t=e.target.value;/^\d*$/.test(t)&&!(t.length>2)&&(parseInt(t,10)>31||(s(t),2===t.length&&(null==u||u())))},[s,u]),N=(0,r.useCallback)((e,t,n)=>{var a,r;"Backspace"===e.key&&(null===(a=t.current)||void 0===a?void 0:a.value)===""&&n&&(e.preventDefault(),null===(r=n.current)||void 0===r||r.focus())},[]),E=d?{borderColor:"var(--tui-error)"}:{};return(0,a.jsxs)("div",{className:"guided-date-input ".concat(p),role:"group","aria-label":"Date input",children:[(0,a.jsx)("input",{ref:g,type:"text",inputMode:"numeric",pattern:"[0-9]*",value:t,onChange:C,onKeyDown:e=>N(e,g),placeholder:f,disabled:c,className:"guided-input-segment guided-input-year tui-input",style:E,"aria-label":"Year",autoComplete:"off"}),(0,a.jsx)("span",{className:"guided-input-separator",children:"/"}),(0,a.jsx)("input",{ref:x,type:"text",inputMode:"numeric",pattern:"[0-9]*",value:n,onChange:w,onKeyDown:e=>N(e,{current:x.current},g),placeholder:h,disabled:c,className:"guided-input-segment guided-input-month tui-input",style:E,"aria-label":"Month",autoComplete:"off"}),(0,a.jsx)("span",{className:"guided-input-separator",children:"/"}),(0,a.jsx)("input",{ref:k,type:"text",inputMode:"numeric",pattern:"[0-9]*",value:l,onChange:D,onKeyDown:e=>N(e,{current:k.current},{current:x.current}),placeholder:m,disabled:c,className:"guided-input-segment guided-input-day tui-input",style:E,"aria-label":"Day",autoComplete:"off"})]})}function c(e){let{hour:t,minute:n,onHourChange:l,onMinuteChange:i,onComplete:o,disabled:s=!1,hasError:u=!1,showUnknownToggle:c=!1,isUnknown:d=!1,onUnknownChange:f,className:h="",autoFocus:m=!1,hourRef:p}=e,y=(0,r.useRef)(null),v=p||y,b=(0,r.useRef)(null),[g,x]=(0,r.useState)(d);(0,r.useEffect)(()=>{x(d)},[d]),(0,r.useEffect)(()=>{m&&v.current&&!g&&v.current.focus()},[m,v,g]);let k=(0,r.useCallback)(e=>{let t=e.target.value;if(!/^\d*$/.test(t)||t.length>2)return;let n=parseInt(t,10);!(n>23)&&(l(t),(2===t.length||1===t.length&&n>2)&&setTimeout(()=>{var e;return null===(e=b.current)||void 0===e?void 0:e.focus()},0))},[l]),j=(0,r.useCallback)(e=>{let t=e.target.value;/^\d*$/.test(t)&&!(t.length>2)&&(parseInt(t,10)>59||(i(t),2===t.length&&(null==o||o())))},[i,o]),C=(0,r.useCallback)((e,t,n)=>{var a,r;"Backspace"===e.key&&(null===(a=t.current)||void 0===a?void 0:a.value)===""&&n&&(e.preventDefault(),null===(r=n.current)||void 0===r||r.focus())},[]),w=(0,r.useCallback)(()=>{let e=!g;x(e),null==f||f(e),e?(l(""),i("")):(l("12"),i("00"),setTimeout(()=>{var e;return null===(e=v.current)||void 0===e?void 0:e.focus()},0))},[g,f,l,i,v]),D=u?{borderColor:"var(--tui-error)"}:{};return g?(0,a.jsxs)("div",{className:"guided-time-input ".concat(h),role:"group","aria-label":"Time input",children:[(0,a.jsx)("span",{className:"guided-time-unknown tui-input tui-text-muted",children:"??:??"}),c&&(0,a.jsx)("button",{type:"button",onClick:w,className:"guided-time-toggle tui-btn tui-border-bright",title:"I know the birth time","aria-pressed":g,children:"?"})]}):(0,a.jsxs)("div",{className:"guided-time-input ".concat(h),role:"group","aria-label":"Time input",children:[(0,a.jsx)("input",{ref:v,type:"text",inputMode:"numeric",pattern:"[0-9]*",value:t,onChange:k,onKeyDown:e=>C(e,v),placeholder:"HH",disabled:s,className:"guided-input-segment guided-input-hour tui-input",style:D,"aria-label":"Hour",autoComplete:"off"}),(0,a.jsx)("span",{className:"guided-input-separator",children:":"}),(0,a.jsx)("input",{ref:b,type:"text",inputMode:"numeric",pattern:"[0-9]*",value:n,onChange:j,onKeyDown:e=>C(e,{current:b.current},v),placeholder:"MM",disabled:s,className:"guided-input-segment guided-input-minute tui-input",style:D,"aria-label":"Minute",autoComplete:"off"}),c&&(0,a.jsx)("button",{type:"button",onClick:w,className:"guided-time-toggle tui-btn",title:"I don't know the birth time","aria-pressed":g,children:"?"})]})}function d(e){let{options:t,value:n,onChange:l,disabled:i=!1,className:o="",name:s="inline-selector",autoFocus:u=!1,onComplete:c}=e,d=(0,r.useRef)(null),f=t.findIndex(e=>e.value===n);(0,r.useEffect)(()=>{u&&d.current&&d.current.focus()},[u]);let h=(0,r.useCallback)(e=>{if(!i){if("ArrowLeft"===e.key||"ArrowUp"===e.key){e.preventDefault();let n=f>0?f-1:t.length-1;l(t[n].value)}else if("ArrowRight"===e.key||"ArrowDown"===e.key){e.preventDefault();let n=f<t.length-1?f+1:0;l(t[n].value)}else if(" "===e.key||"Enter"===e.key)e.preventDefault(),null==c||c();else{let n=e.key.toLowerCase(),a=t.find(e=>{var t;return(null===(t=e.shortcut)||void 0===t?void 0:t.toLowerCase())===n});a&&(e.preventDefault(),l(a.value),setTimeout(()=>null==c?void 0:c(),50))}}},[i,f,t,l,c]),m=(0,r.useCallback)(e=>{var t;i||(l(e),null===(t=d.current)||void 0===t||t.focus())},[i,l]);return(0,a.jsx)("div",{ref:d,className:"inline-selector ".concat(o),role:"radiogroup","aria-label":s,tabIndex:i?-1:0,onKeyDown:h,children:t.map(e=>{let t=e.value===n;return(0,a.jsxs)("label",{className:"inline-selector-option ".concat(t?"inline-selector-option-selected":""),onClick:()=>m(e.value),children:[(0,a.jsx)("input",{type:"radio",name:s,value:String(e.value),checked:t,onChange:()=>l(e.value),disabled:i,className:"sr-only","aria-checked":t}),(0,a.jsxs)("span",{className:t?"tui-text":"tui-text-muted",children:["(",t?"●":"○",")",e.label,e.shortcut&&(0,a.jsxs)("span",{className:"inline-selector-shortcut",children:["[",e.shortcut.toUpperCase(),"]"]})]})]},String(e.value))})})}function f(e){let{value:t,onChange:n,disabled:r,className:l,autoFocus:i,onComplete:o}=e;return(0,a.jsx)(d,{options:[{value:"male",label:"M",shortcut:"m"},{value:"female",label:"F",shortcut:"f"}],value:t,onChange:n,disabled:r,className:l,name:"gender",autoFocus:i,onComplete:o})}},8129:function(e,t,n){n.d(t,{he:function(){return r},k1:function(){return a},sg:function(){return l}});let a=["en","id","zh"],r={en:"English",id:"Bahasa Indonesia",zh:"中文"},l={en:"\uD83C\uDDFA\uD83C\uDDF8",id:"\uD83C\uDDEE\uD83C\uDDE9",zh:"\uD83C\uDDE8\uD83C\uDDF3"}},1837:function(e,t,n){n.d(t,{Ai:function(){return c},Di:function(){return p},ED:function(){return d},H4:function(){return v},SB:function(){return y},_j:function(){return m},ck:function(){return f},cp:function(){return u},he:function(){return h}});var a,r,l,i=n(257);let o=(null===(r=window.Capacitor)||void 0===r?void 0:null===(a=r.isNativePlatform)||void 0===a?void 0:a.call(r))||(null===(l=window.Capacitor)||void 0===l?void 0:l.platform)!=="web",s=i.env.NEXT_PUBLIC_API_URL||("localhost"===window.location.hostname||o?"http://localhost:8008":"");async function u(){let e=await fetch("".concat(s,"/api/profiles"));if(!e.ok)throw Error("Failed to fetch profiles");return e.json()}async function c(e){let t=await fetch("".concat(s,"/api/profiles/").concat(e));if(!t.ok){if(404===t.status)throw Error("Profile not found");throw Error("Failed to fetch profile")}return t.json()}async function d(e){let t=await fetch("".concat(s,"/api/profiles"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json().catch(()=>({}))).detail||"Failed to create profile");return t.json()}async function f(e,t){let n=await fetch("".concat(s,"/api/profiles/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok){if(404===n.status)throw Error("Profile not found");throw Error("Failed to update profile")}return n.json()}async function h(e){let t=await fetch("".concat(s,"/api/profiles/").concat(e),{method:"DELETE"});if(!t.ok){if(404===t.status)throw Error("Profile not found");throw Error("Failed to delete profile")}}async function m(e,t){let n=await fetch("".concat(s,"/api/profiles/").concat(e,"/life_events"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok){if(404===n.status)throw Error("Profile not found");throw Error((await n.json().catch(()=>({}))).detail||"Failed to create life event")}return n.json()}async function p(e,t,n){let a=await fetch("".concat(s,"/api/profiles/").concat(e,"/life_events/").concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!a.ok){if(404===a.status)throw Error("Life event not found");throw Error("Failed to update life event")}return a.json()}async function y(e,t){let n=await fetch("".concat(s,"/api/profiles/").concat(e,"/life_events/").concat(t),{method:"DELETE"});if(!n.ok){if(404===n.status)throw Error("Life event not found");throw Error("Failed to delete life event")}}async function v(e){let t=e.unknownHour?"unknown":e.birthTime,n="".concat(s,"/api/analyze_bazi?birth_date=").concat(e.birthDate,"&birth_time=").concat(encodeURIComponent(t),"&gender=").concat(e.gender);if(e.analysisYear){var a;n+="&analysis_year=".concat(e.analysisYear)+"&include_annual_luck=".concat(null===(a=e.includeAnnualLuck)||void 0===a||a),e.analysisMonth&&e.includeMonthlyLuck&&(n+="&analysis_month=".concat(e.analysisMonth)),e.analysisDay&&e.includeDailyLuck&&(n+="&analysis_day=".concat(e.analysisDay)),e.analysisTime&&e.includeHourlyLuck&&(n+="&analysis_time=".concat(encodeURIComponent(e.analysisTime)))}e.showTalismans&&(e.talismanYearHS&&(n+="&talisman_year_hs=".concat(e.talismanYearHS)),e.talismanYearEB&&(n+="&talisman_year_eb=".concat(e.talismanYearEB)),e.talismanMonthHS&&(n+="&talisman_month_hs=".concat(e.talismanMonthHS)),e.talismanMonthEB&&(n+="&talisman_month_eb=".concat(e.talismanMonthEB)),e.talismanDayHS&&(n+="&talisman_day_hs=".concat(e.talismanDayHS)),e.talismanDayEB&&(n+="&talisman_day_eb=".concat(e.talismanDayEB)),e.talismanHourHS&&(n+="&talisman_hour_hs=".concat(e.talismanHourHS)),e.talismanHourEB&&(n+="&talisman_hour_eb=".concat(e.talismanHourEB))),e.showLocation&&e.locationType&&(n+="&location=".concat(e.locationType));let r=await fetch(n);if(!r.ok){let e="Chart API request failed";try{let t=await r.json();t.detail?e="string"==typeof t.detail?t.detail:JSON.stringify(t.detail):t.message&&(e=t.message)}catch(t){e="API error: ".concat(r.status," ").concat(r.statusText)}throw Error(e)}return r.json()}}}]);